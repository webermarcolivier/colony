<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Colony: CellCollection Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CellCollection Class Reference</h1><!-- doxytag: class="CellCollection" -->A collection of cells.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;CellCollection.h&gt;</code>
<p>

<p>
<a href="classCellCollection-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#827aba3bcb4e7cad6d6d7a516a311582">CellCollection</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#6fff17151933d645fac4888fe2e442b9">~CellCollection</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#2c99c219e98f83efa5c4f4a8526bfe98">initializeHomogeneousCellCollection</a> (CellCollectionParam &amp;p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a homogeneous collection of cells.  <a href="#2c99c219e98f83efa5c4f4a8526bfe98"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#b931d338749814ce3208261a162c202c">initializeHomogeneousCellCollection</a> (<a class="el" href="classInput.html">Input</a> &amp;input)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a homogeneous collection of cells.  <a href="#b931d338749814ce3208261a162c202c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="classCell.html">Cell</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#3599c6632ae194366f8823d98fe4ac2e">operator[]</a> (int i) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Random access to the cells.  <a href="#3599c6632ae194366f8823d98fe4ac2e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classCell.html">Cell</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#3f4df67dc0c0810e56910c7c2c61eee0">operator[]</a> (int i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classMilieu.html">Milieu</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#1a05ae2b39fa7d1975fd915ac782b55f">getMilieu</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Non-constant access to the milieu.  <a href="#1a05ae2b39fa7d1975fd915ac782b55f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#7e7033870c2939e540e384a4e73943be">getNCells</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the number of cells.  <a href="#7e7033870c2939e540e384a4e73943be"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#0c5d702860a478ba49d95ab1315bbc3b">getTimeDependentVolumes</a> (const double time) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#955d5ddfbedf013e30e6b525a7ddcfa1">getGlobalPropensities</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the global array of propensities.  <a href="#955d5ddfbedf013e30e6b525a7ddcfa1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; int, 1 &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#025a9257c4f04866076cfa34efcef753">getGlobalX</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#fd9e296d8bcec397103ce8e821e1f14f">getXConc</a> (const double time)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remark: XConc is not a global array, it is constructed from the concentration arrays of the cells.  <a href="#fd9e296d8bcec397103ce8e821e1f14f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#994fcfe5ce2b2bbf1095ef2e5d464919">getSumPropensities</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#68908bf5abda3a9ccdfcf2091e806f24">getCellIndexFromGlobalChannelIndex</a> (int mu)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#654fd71e9f104982f1453c5aafbc6fda">getTimeNextDivision</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#8100eb42a76f3695e7a4aeabc6d13650">getCellCyclePhases</a> (const double time) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">list&lt; <a class="el" href="classCellLineageGeneration.html">CellLineageGeneration</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#f142c6b0baeeeb2ec63a4c75d0170ad3">getCellLineage</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#09289829176cd533054d316240a53ebf">getCellsAngle</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; TinyVector&lt; double, 2 &gt;, 1 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#d589b7b2fc5c7f95fe01d61ede3d49f1">getCellsPosition</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">vector&lt; string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#dd9fd6b9bbc126e0e407dd16b0d6f9ba">getListSpeciesName</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#75dc07332a3f267bc702554e4aa4e6cd">setCellsAngle</a> (Array&lt; double, 1 &gt; cellsAngleArray)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#93c97175010bfda00477602405be27f4">setCellsPosition</a> (Array&lt; TinyVector&lt; double, 2 &gt;, 1 &gt; cellsPositionArray)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#4b73332003358f0f06a0def79002417b">computeAllCellsAndGetPropensities</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute and get propensities of all reaction channels (including intercellular or cell-milieu reactions).  <a href="#4b73332003358f0f06a0def79002417b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#4882ea6a3f20a950723b21ec9e152b33">computeAndGetPropensities</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute and get propensities of all reaction channels (including intercellular or cell-milieu reactions).  <a href="#4882ea6a3f20a950723b21ec9e152b33"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; double, 1 &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#eb934fdf5a82b1c4406fc93da6a09c04">computeAndGetPropensitiesModified</a> (const double time)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#5ba177ec9cdbd54e973f518ec5aa1c15">computeTimeDependentPropensities</a> (const double time)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#fd23a12746264399da0d7b92636fbcec">computePropensitiesAllInternalTimeDependentReactions</a> (const double time)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#33f98ed9d986282595770bd99f3dca98">getSumPropensitiesAllInternalTimeDependentReactions</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#4776a24572a3deadac395807a04ae358">initializeSumPropensities</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the sum of propensities.  <a href="#4776a24572a3deadac395807a04ae358"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#aaa508931fe5f373554336817f47c0f1">initializeSumPropensities</a> (const double time)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#bbe2af90b96ba11f1610c1563a006a29">applyNextDivisionEvent</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Divide the cell(s) that are next in the division events list.  <a href="#bbe2af90b96ba11f1610c1563a006a29"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#f419ee956df66b05cf1ef979a3de9667">deleteCell</a> (int i, const double time)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete cell <code>i</code>.  <a href="#f419ee956df66b05cf1ef979a3de9667"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#6305f9a2d18d0dd277693b7154794b0d">buildListDivisionEvents</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Build the list of upcoming division events.  <a href="#6305f9a2d18d0dd277693b7154794b0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#14a8c92a2646731e6384d4f7ddcb49a9">applyReaction</a> (int mu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a reaction corresponding to reaction channel <code>mu</code> (global index).  <a href="#14a8c92a2646731e6384d4f7ddcb49a9"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#ca94da1997cf9f225b83cab9d55657dc">duplicateCell</a> (int i)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Duplicate cell <code>i</code>.  <a href="#ca94da1997cf9f225b83cab9d55657dc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#a6478a45d64298b22ffbb93d48e6082e">getSumPropensitiesAllCellsMilieuReactions</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the sum of the propensities of the cell-milieu reactions of all cells.  <a href="#a6478a45d64298b22ffbb93d48e6082e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#8566f6399e43c80c90f120e9e6883bbf">computePropensitiesCellMilieuAllCells</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the propensities of the cell-milieu reactions of all cells.  <a href="#8566f6399e43c80c90f120e9e6883bbf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#9b1d8b45ea614cd77251c168fe374c6a">computePropensitiesCellMilieuAllCells</a> (const double time)</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#3b8ca4eb69848b1b85747f034b6eaff8">nCells_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of cells in the cell collection.  <a href="#3b8ca4eb69848b1b85747f034b6eaff8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Array&lt; <a class="el" href="classCell.html">Cell</a>, 1 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#005fbe2668311462068fd7e9c25eeeb4">cells_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The collection of cell objects is contained in a Blitz++ array.  <a href="#005fbe2668311462068fd7e9c25eeeb4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classMilieu.html">Milieu</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#0ce684ae435a0e7d1eb8f9a5ef99d92c">milieu_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classMilieu.html" title="A special cell that represents the environment in which the colony of cells live...">Milieu</a> cell object that represents the milieu / environment where the cells are living.  <a href="#0ce684ae435a0e7d1eb8f9a5ef99d92c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classGlobalArrayInterface.html">GlobalArrayInterface</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#7f6649b805665de375fb68045cdc8289">globalArrayInterface_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The <a class="el" href="classGlobalArrayInterface.html" title="Interface between the class CellCollection and the class GlobalArray.">GlobalArrayInterface</a> class defines the interface to the class that handle global arrays.  <a href="#7f6649b805665de375fb68045cdc8289"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">multimap&lt; double, int &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#b3b59dae2c7644730b50923be7f52699">listDivisionEvents_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of the upcoming cell division events.  <a href="#b3b59dae2c7644730b50923be7f52699"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">list&lt; <a class="el" href="classCellLineageGeneration.html">CellLineageGeneration</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#6503b63a9d9234643216a59d629f9a13">cellLineage_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List that contains information about the cell lineage.  <a href="#6503b63a9d9234643216a59d629f9a13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#e5e5b72f8289729a05ad9a99261aae3c">lastReactionCellIndex_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Temporary variable: index of the cell in which the reaction of previous integration step happened.  <a href="#e5e5b72f8289729a05ad9a99261aae3c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#8ba225f0f112418af5130c4950797b17">isLastReactionInternal_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Temporary variable: indicates if the reaction that happened at the previous integration step was an internal (cell) reaction or an external (cell-milieu) reaction.  <a href="#8ba225f0f112418af5130c4950797b17"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#a1e17afe9b58ca957c763a94db81f302">sumPropensities_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Temporary variable: true if the last reaction was an intracellular and false if it was a cell-milieu reaction.  <a href="#a1e17afe9b58ca957c763a94db81f302"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#aa71cbc6d4145167722309e835901f8e">constantCellDensity_</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If true the cell density is kept constant by automatically killing the cells (at random) when cells duplicate.  <a href="#aa71cbc6d4145167722309e835901f8e"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCellCollection.html#b0a78cc0f31cec81458f40ab27bc7beb">operator&lt;&lt;</a> (ostream &amp;out, const <a class="el" href="classCellCollection.html">CellCollection</a> &amp;cellCollection)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Operator that outputs the content of all cells.  <a href="#b0a78cc0f31cec81458f40ab27bc7beb"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A collection of cells. 
<p>
<a class="el" href="classCellCollection.html" title="A collection of cells.">CellCollection</a> contains a collection of cells and constitute the framework for interacting with it and handling it. It defines the methods to initialize a collection, access a particular cell by its index, delete and duplicate one cell.<p>
It also defines an operation to compute the propensities of all reaction channels in the collection and an operation to apply a reaction event. <hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="827aba3bcb4e7cad6d6d7a516a311582"></a><!-- doxytag: member="CellCollection::CellCollection" ref="827aba3bcb4e7cad6d6d7a516a311582" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CellCollection::CellCollection           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="6fff17151933d645fac4888fe2e442b9"></a><!-- doxytag: member="CellCollection::~CellCollection" ref="6fff17151933d645fac4888fe2e442b9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CellCollection::~CellCollection           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="2c99c219e98f83efa5c4f4a8526bfe98"></a><!-- doxytag: member="CellCollection::initializeHomogeneousCellCollection" ref="2c99c219e98f83efa5c4f4a8526bfe98" args="(CellCollectionParam &amp;p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::initializeHomogeneousCellCollection           </td>
          <td>(</td>
          <td class="paramtype">CellCollectionParam &amp;&nbsp;</td>
          <td class="paramname"> <em>p</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize a homogeneous collection of cells. 
<p>
Each cell is initialized with the same parameters. The milieu is also initialized. 
</div>
</div><p>
<a class="anchor" name="b931d338749814ce3208261a162c202c"></a><!-- doxytag: member="CellCollection::initializeHomogeneousCellCollection" ref="b931d338749814ce3208261a162c202c" args="(Input &amp;input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::initializeHomogeneousCellCollection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInput.html">Input</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>input</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize a homogeneous collection of cells. 
<p>
Each cell is initialized with the same parameters. The milieu is also initialized. This version of the method takes as argument an <a class="el" href="classInput.html" title="Input parameters read from files &quot;input.dat&quot; and &quot;input_simulation...">Input</a> object that contains the parameters. 
</div>
</div><p>
<a class="anchor" name="3599c6632ae194366f8823d98fe4ac2e"></a><!-- doxytag: member="CellCollection::operator[]" ref="3599c6632ae194366f8823d98fe4ac2e" args="(int i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classCell.html">Cell</a> &amp; CellCollection::operator[]           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Random access to the cells. 
<p>

</div>
</div><p>
<a class="anchor" name="3f4df67dc0c0810e56910c7c2c61eee0"></a><!-- doxytag: member="CellCollection::operator[]" ref="3f4df67dc0c0810e56910c7c2c61eee0" args="(int i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCell.html">Cell</a> &amp; CellCollection::operator[]           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="1a05ae2b39fa7d1975fd915ac782b55f"></a><!-- doxytag: member="CellCollection::getMilieu" ref="1a05ae2b39fa7d1975fd915ac782b55f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMilieu.html">Milieu</a> &amp; CellCollection::getMilieu           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Non-constant access to the milieu. 
<p>

</div>
</div><p>
<a class="anchor" name="7e7033870c2939e540e384a4e73943be"></a><!-- doxytag: member="CellCollection::getNCells" ref="7e7033870c2939e540e384a4e73943be" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CellCollection::getNCells           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the number of cells. 
<p>

</div>
</div><p>
<a class="anchor" name="0c5d702860a478ba49d95ab1315bbc3b"></a><!-- doxytag: member="CellCollection::getTimeDependentVolumes" ref="0c5d702860a478ba49d95ab1315bbc3b" args="(const double time) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; double, 1 &gt; CellCollection::getTimeDependentVolumes           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="955d5ddfbedf013e30e6b525a7ddcfa1"></a><!-- doxytag: member="CellCollection::getGlobalPropensities" ref="955d5ddfbedf013e30e6b525a7ddcfa1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; double, 1 &gt; &amp; CellCollection::getGlobalPropensities           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the global array of propensities. 
<p>
Get the global array of propensities of the whole cell collection, including the cell-milieu reaction channels. 
</div>
</div><p>
<a class="anchor" name="025a9257c4f04866076cfa34efcef753"></a><!-- doxytag: member="CellCollection::getGlobalX" ref="025a9257c4f04866076cfa34efcef753" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; int, 1 &gt; &amp; CellCollection::getGlobalX           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="fd9e296d8bcec397103ce8e821e1f14f"></a><!-- doxytag: member="CellCollection::getXConc" ref="fd9e296d8bcec397103ce8e821e1f14f" args="(const double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; double, 1 &gt; CellCollection::getXConc           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remark: XConc is not a global array, it is constructed from the concentration arrays of the cells. 
<p>

</div>
</div><p>
<a class="anchor" name="994fcfe5ce2b2bbf1095ef2e5d464919"></a><!-- doxytag: member="CellCollection::getSumPropensities" ref="994fcfe5ce2b2bbf1095ef2e5d464919" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CellCollection::getSumPropensities           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="68908bf5abda3a9ccdfcf2091e806f24"></a><!-- doxytag: member="CellCollection::getCellIndexFromGlobalChannelIndex" ref="68908bf5abda3a9ccdfcf2091e806f24" args="(int mu)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CellCollection::getCellIndexFromGlobalChannelIndex           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mu</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="654fd71e9f104982f1453c5aafbc6fda"></a><!-- doxytag: member="CellCollection::getTimeNextDivision" ref="654fd71e9f104982f1453c5aafbc6fda" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CellCollection::getTimeNextDivision           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="8100eb42a76f3695e7a4aeabc6d13650"></a><!-- doxytag: member="CellCollection::getCellCyclePhases" ref="8100eb42a76f3695e7a4aeabc6d13650" args="(const double time) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; double, 1 &gt; CellCollection::getCellCyclePhases           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="f142c6b0baeeeb2ec63a4c75d0170ad3"></a><!-- doxytag: member="CellCollection::getCellLineage" ref="f142c6b0baeeeb2ec63a4c75d0170ad3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list&lt; <a class="el" href="classCellLineageGeneration.html">CellLineageGeneration</a> &gt; CellCollection::getCellLineage           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="09289829176cd533054d316240a53ebf"></a><!-- doxytag: member="CellCollection::getCellsAngle" ref="09289829176cd533054d316240a53ebf" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; double, 1 &gt; CellCollection::getCellsAngle           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="d589b7b2fc5c7f95fe01d61ede3d49f1"></a><!-- doxytag: member="CellCollection::getCellsPosition" ref="d589b7b2fc5c7f95fe01d61ede3d49f1" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; TinyVector&lt; double, 2 &gt;, 1 &gt; CellCollection::getCellsPosition           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="dd9fd6b9bbc126e0e407dd16b0d6f9ba"></a><!-- doxytag: member="CellCollection::getListSpeciesName" ref="dd9fd6b9bbc126e0e407dd16b0d6f9ba" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; CellCollection::getListSpeciesName           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="75dc07332a3f267bc702554e4aa4e6cd"></a><!-- doxytag: member="CellCollection::setCellsAngle" ref="75dc07332a3f267bc702554e4aa4e6cd" args="(Array&lt; double, 1 &gt; cellsAngleArray)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::setCellsAngle           </td>
          <td>(</td>
          <td class="paramtype">Array&lt; double, 1 &gt;&nbsp;</td>
          <td class="paramname"> <em>cellsAngleArray</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="93c97175010bfda00477602405be27f4"></a><!-- doxytag: member="CellCollection::setCellsPosition" ref="93c97175010bfda00477602405be27f4" args="(Array&lt; TinyVector&lt; double, 2 &gt;, 1 &gt; cellsPositionArray)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::setCellsPosition           </td>
          <td>(</td>
          <td class="paramtype">Array&lt; TinyVector&lt; double, 2 &gt;, 1 &gt;&nbsp;</td>
          <td class="paramname"> <em>cellsPositionArray</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="4b73332003358f0f06a0def79002417b"></a><!-- doxytag: member="CellCollection::computeAllCellsAndGetPropensities" ref="4b73332003358f0f06a0def79002417b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt;double,1&gt;&amp; CellCollection::computeAllCellsAndGetPropensities           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute and get propensities of all reaction channels (including intercellular or cell-milieu reactions). 
<p>

</div>
</div><p>
<a class="anchor" name="4882ea6a3f20a950723b21ec9e152b33"></a><!-- doxytag: member="CellCollection::computeAndGetPropensities" ref="4882ea6a3f20a950723b21ec9e152b33" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; double, 1 &gt; &amp; CellCollection::computeAndGetPropensities           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute and get propensities of all reaction channels (including intercellular or cell-milieu reactions). 
<p>
This method is optimized by using the <a class="el" href="classCellCollection.html#e5e5b72f8289729a05ad9a99261aae3c" title="Temporary variable: index of the cell in which the reaction of previous integration...">lastReactionCellIndex_</a>. Compute propensities ONLY in cell i: at each step, we keep track of the cell index <a class="el" href="classCellCollection.html#e5e5b72f8289729a05ad9a99261aae3c" title="Temporary variable: index of the cell in which the reaction of previous integration...">lastReactionCellIndex_</a> where the reaction happens, and at next step, we compute the propensities only in this cell and the milieu (because only in these cells the internal state has changed). 
</div>
</div><p>
<a class="anchor" name="eb934fdf5a82b1c4406fc93da6a09c04"></a><!-- doxytag: member="CellCollection::computeAndGetPropensitiesModified" ref="eb934fdf5a82b1c4406fc93da6a09c04" args="(const double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; double, 1 &gt; &amp; CellCollection::computeAndGetPropensitiesModified           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5ba177ec9cdbd54e973f518ec5aa1c15"></a><!-- doxytag: member="CellCollection::computeTimeDependentPropensities" ref="5ba177ec9cdbd54e973f518ec5aa1c15" args="(const double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::computeTimeDependentPropensities           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="fd23a12746264399da0d7b92636fbcec"></a><!-- doxytag: member="CellCollection::computePropensitiesAllInternalTimeDependentReactions" ref="fd23a12746264399da0d7b92636fbcec" args="(const double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::computePropensitiesAllInternalTimeDependentReactions           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="33f98ed9d986282595770bd99f3dca98"></a><!-- doxytag: member="CellCollection::getSumPropensitiesAllInternalTimeDependentReactions" ref="33f98ed9d986282595770bd99f3dca98" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CellCollection::getSumPropensitiesAllInternalTimeDependentReactions           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="4776a24572a3deadac395807a04ae358"></a><!-- doxytag: member="CellCollection::initializeSumPropensities" ref="4776a24572a3deadac395807a04ae358" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::initializeSumPropensities           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize the sum of propensities. 
<p>
We substract the sum of propensities from the milieu and set artificially the lastReactionCellIndex to -1 (corresponding to the milieu), in order to ensure the good initialization of the optimized sum of the propensities. This initialization has to be applied after dividing or deleting a cell. 
</div>
</div><p>
<a class="anchor" name="aaa508931fe5f373554336817f47c0f1"></a><!-- doxytag: member="CellCollection::initializeSumPropensities" ref="aaa508931fe5f373554336817f47c0f1" args="(const double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::initializeSumPropensities           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ca94da1997cf9f225b83cab9d55657dc"></a><!-- doxytag: member="CellCollection::duplicateCell" ref="ca94da1997cf9f225b83cab9d55657dc" args="(int i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::duplicateCell           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Duplicate cell <code>i</code>. 
<p>
The cell is duplicated and proteins are distributed between mother and daughter cells with binomial probability.<ul>
<li>Substract the volume of the cell V0 to the volume of the milieu. (Remark: The dynamic variation of cells volume is not taken into account for keeping the milieu's volume constant.).</li><li>Increase the size of the cells array with the resizeAndPreserve method.</li><li>Call the duplicate method of cell <code>i</code> and copy the daughter cell to the new slot.</li><li>nCells++</li><li>Rebuild global arrays.</li><li>Rebuild the list of the upcoming cell division events. </li></ul>

</div>
</div><p>
<a class="anchor" name="a6478a45d64298b22ffbb93d48e6082e"></a><!-- doxytag: member="CellCollection::getSumPropensitiesAllCellsMilieuReactions" ref="a6478a45d64298b22ffbb93d48e6082e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CellCollection::getSumPropensitiesAllCellsMilieuReactions           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute the sum of the propensities of the cell-milieu reactions of all cells. 
<p>

</div>
</div><p>
<a class="anchor" name="8566f6399e43c80c90f120e9e6883bbf"></a><!-- doxytag: member="CellCollection::computePropensitiesCellMilieuAllCells" ref="8566f6399e43c80c90f120e9e6883bbf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::computePropensitiesCellMilieuAllCells           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute the propensities of the cell-milieu reactions of all cells. 
<p>

</div>
</div><p>
<a class="anchor" name="9b1d8b45ea614cd77251c168fe374c6a"></a><!-- doxytag: member="CellCollection::computePropensitiesCellMilieuAllCells" ref="9b1d8b45ea614cd77251c168fe374c6a" args="(const double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::computePropensitiesCellMilieuAllCells           </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="bbe2af90b96ba11f1610c1563a006a29"></a><!-- doxytag: member="CellCollection::applyNextDivisionEvent" ref="bbe2af90b96ba11f1610c1563a006a29" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::applyNextDivisionEvent           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Divide the cell(s) that are next in the division events list. 
<p>
This method looks at the list of division events and divide the cell that is next in the list. In the case that several cells have exactly the same time of next division, we divide all these cells. 
</div>
</div><p>
<a class="anchor" name="f419ee956df66b05cf1ef979a3de9667"></a><!-- doxytag: member="CellCollection::deleteCell" ref="f419ee956df66b05cf1ef979a3de9667" args="(int i, const double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::deleteCell           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>time</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete cell <code>i</code>. 
<p>
<ul>
<li>Add the volume of the cell to the volume of the milieu.</li><li>Make a copy of cells array.</li><li>Resize the cells array to nCells-1.</li><li>Copy back the cells (0,...,i-1,i+1,...,nCells) into the cells array.</li><li>nCells--</li><li>Update the cell generation list.</li><li>Rebuild global arrays.</li><li>Rebuild the list of the upcoming cell division events. </li></ul>

</div>
</div><p>
<a class="anchor" name="6305f9a2d18d0dd277693b7154794b0d"></a><!-- doxytag: member="CellCollection::buildListDivisionEvents" ref="6305f9a2d18d0dd277693b7154794b0d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::buildListDivisionEvents           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Build the list of upcoming division events. 
<p>
This functions is called from the <a class="el" href="classCellCollection.html#f419ee956df66b05cf1ef979a3de9667" title="Delete cell i.">deleteCell()</a> method. It iterates over the cells to get the value of their timeNextDivision and their cell index and build the list. It is necessary to rebuild the list when deleting one cell because almost all the cell indices are changed after the deletion (by shifting). Thus, it is simpler to rebuild the entire list than changing the value of the cell index in each element. 
</div>
</div><p>
<a class="anchor" name="14a8c92a2646731e6384d4f7ddcb49a9"></a><!-- doxytag: member="CellCollection::applyReaction" ref="14a8c92a2646731e6384d4f7ddcb49a9" args="(int mu)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CellCollection::applyReaction           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mu</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Apply a reaction corresponding to reaction channel <code>mu</code> (global index). 
<p>
<ul>
<li>Find cell number <code>k</code> and local channel number <code>mu_k</code>.</li><li>If <code>k</code> = -1<ul>
<li>Apply reaction <code>mu_k</code> in the milieu.</li></ul>
</li><li>else<ul>
<li>Apply reaction <code>mu_k</code> in cell <code>k</code>. </li></ul>
</li></ul>

</div>
</div><p>
<hr><h2>Friends And Related Function Documentation</h2>
<a class="anchor" name="b0a78cc0f31cec81458f40ab27bc7beb"></a><!-- doxytag: member="CellCollection::operator&lt;&lt;" ref="b0a78cc0f31cec81458f40ab27bc7beb" args="(ostream &amp;out, const CellCollection &amp;cellCollection)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ostream&amp; operator&lt;&lt;           </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCellCollection.html">CellCollection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>cellCollection</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Operator that outputs the content of all cells. 
<p>
Remark: it is declared as a friend operator, so that it has access to the private part of the class. 
</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="3b8ca4eb69848b1b85747f034b6eaff8"></a><!-- doxytag: member="CellCollection::nCells_" ref="3b8ca4eb69848b1b85747f034b6eaff8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classCellCollection.html#3b8ca4eb69848b1b85747f034b6eaff8">CellCollection::nCells_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of cells in the cell collection. 
<p>
Remark that this does not include the milieu, which is considered as a special cell. 
</div>
</div><p>
<a class="anchor" name="005fbe2668311462068fd7e9c25eeeb4"></a><!-- doxytag: member="CellCollection::cells_" ref="005fbe2668311462068fd7e9c25eeeb4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt;<a class="el" href="classCell.html">Cell</a>,1&gt; <a class="el" href="classCellCollection.html#005fbe2668311462068fd7e9c25eeeb4">CellCollection::cells_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The collection of cell objects is contained in a Blitz++ array. 
<p>
This will ensure a good performance for random access to the cells (by index). The drawback is that when deleting a cell, we have to perform complicated copying operations. We suppose that duplicating/deleting events are rare, so the lost in performance is negligable. 
</div>
</div><p>
<a class="anchor" name="0ce684ae435a0e7d1eb8f9a5ef99d92c"></a><!-- doxytag: member="CellCollection::milieu_" ref="0ce684ae435a0e7d1eb8f9a5ef99d92c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMilieu.html">Milieu</a> <a class="el" href="classCellCollection.html#0ce684ae435a0e7d1eb8f9a5ef99d92c">CellCollection::milieu_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="classMilieu.html" title="A special cell that represents the environment in which the colony of cells live...">Milieu</a> cell object that represents the milieu / environment where the cells are living. 
<p>
It functions as a normal cell in the sense that it can define some chemical species and reactions. <a class="el" href="classMilieu.html" title="A special cell that represents the environment in which the colony of cells live...">Milieu</a> can only have one instance. 
</div>
</div><p>
<a class="anchor" name="7f6649b805665de375fb68045cdc8289"></a><!-- doxytag: member="CellCollection::globalArrayInterface_" ref="7f6649b805665de375fb68045cdc8289" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGlobalArrayInterface.html">GlobalArrayInterface</a> <a class="el" href="classCellCollection.html#7f6649b805665de375fb68045cdc8289">CellCollection::globalArrayInterface_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The <a class="el" href="classGlobalArrayInterface.html" title="Interface between the class CellCollection and the class GlobalArray.">GlobalArrayInterface</a> class defines the interface to the class that handle global arrays. 
<p>
These are contiguous arrays that gather up the internal arrays of all cells in order to be able to keep all cell data in a unique place. This way, the global array can be passed easily to the integrator interface. Moreover, the local/internal arrays of the cells are referenced to a part of the global array, i.e. they are sharing the same data. We have a transparent manner of accessing the arrays, at the level of the cell collection (global array) or at the level of the cell (local array). Any changes made to the local array <a class="el" href="classCell.html#ebcb4b6db88c0674224bc878037c9253" title="Array containing the propensities of all reactions channels, including internal reactions...">Cell::totalPropensities_</a> when calling the <a class="el" href="classCell.html#d872f4f01c39feb953ee27a9d37963af" title="Compute the propensities of all reaction channels, including the internal and cell-milieu...">Cell::computePropensities()</a> method in a cell will also be reflected in the global array, because they refer to the same data.<p>
Remark 1: When deleting or adding a cell, the global array need to be completely rebuild. 
</div>
</div><p>
<a class="anchor" name="b3b59dae2c7644730b50923be7f52699"></a><!-- doxytag: member="CellCollection::listDivisionEvents_" ref="b3b59dae2c7644730b50923be7f52699" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">multimap&lt;double,int&gt; <a class="el" href="classCellCollection.html#b3b59dae2c7644730b50923be7f52699">CellCollection::listDivisionEvents_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
List of the upcoming cell division events. 
<p>
This list is used to know what is the next cell divison event and when it will happen. It is implemented using the multimap container from the STL. Each element in the multimap has a key equal to the time of next division event with the cell index as mapped value. The multimap always stays in a sorted order following the &lt; comparison for the key values (times of division).<p>
Remark: The cell index refers to the cells array in the state when the list was built. When applying a division event, the array has one more element and its size is increased to nCells+1. However, the new daughter cell is inserted at the very end of the array, thus indices from 0,...,nCells-1 can still be used to refer to the cells and are consistent with the indices before the division. This is especially important when two or more cells have the same division event time and are divided at the same time. 
</div>
</div><p>
<a class="anchor" name="6503b63a9d9234643216a59d629f9a13"></a><!-- doxytag: member="CellCollection::cellLineage_" ref="6503b63a9d9234643216a59d629f9a13" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list&lt;<a class="el" href="classCellLineageGeneration.html">CellLineageGeneration</a>&gt; <a class="el" href="classCellCollection.html#6503b63a9d9234643216a59d629f9a13">CellCollection::cellLineage_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
List that contains information about the cell lineage. 
<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classCellLineageGeneration.html" title="Cell lineage event defining the genealogy of cells after a change in cell number...">CellLineageGeneration</a>. </dd></dl>

</div>
</div><p>
<a class="anchor" name="e5e5b72f8289729a05ad9a99261aae3c"></a><!-- doxytag: member="CellCollection::lastReactionCellIndex_" ref="e5e5b72f8289729a05ad9a99261aae3c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classCellCollection.html#e5e5b72f8289729a05ad9a99261aae3c">CellCollection::lastReactionCellIndex_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Temporary variable: index of the cell in which the reaction of previous integration step happened. 
<p>
This index is used to optimize the integration algorithm: <dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classCellCollection.html#4882ea6a3f20a950723b21ec9e152b33" title="Compute and get propensities of all reaction channels (including intercellular or...">computeAndGetPropensities()</a> <p>
computeSumPropensities()</dd></dl>
Remark: if the reaction happened in the milieu, it is set to -1. 
</div>
</div><p>
<a class="anchor" name="8ba225f0f112418af5130c4950797b17"></a><!-- doxytag: member="CellCollection::isLastReactionInternal_" ref="8ba225f0f112418af5130c4950797b17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classCellCollection.html#8ba225f0f112418af5130c4950797b17">CellCollection::isLastReactionInternal_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Temporary variable: indicates if the reaction that happened at the previous integration step was an internal (cell) reaction or an external (cell-milieu) reaction. 
<p>
This index is used to optimize the integration algorithm: <dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classCellCollection.html#4882ea6a3f20a950723b21ec9e152b33" title="Compute and get propensities of all reaction channels (including intercellular or...">computeAndGetPropensities()</a> <p>
computeSumPropensities()</dd></dl>
Remark: if the reaction happened in the milieu, then it cannot be external (by definition, the milieu object does not have any external reactions). 
</div>
</div><p>
<a class="anchor" name="a1e17afe9b58ca957c763a94db81f302"></a><!-- doxytag: member="CellCollection::sumPropensities_" ref="a1e17afe9b58ca957c763a94db81f302" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classCellCollection.html#a1e17afe9b58ca957c763a94db81f302">CellCollection::sumPropensities_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Temporary variable: true if the last reaction was an intracellular and false if it was a cell-milieu reaction. 
<p>
Temporary variable: sum of the propensities. Used in the optimization of the computation of the sum of all the propensities. The idea of the optimization stands as follows:<ul>
<li>The next reaction to occur introduces a change in the state of the system, but only in the number of molecules of the species involved in the reaction. We assume that there is only a reduced set of reaction channels whose propensities depend on the species number that has changed during the reaction. Then, we only need to update the propensities of the reaction channels that are affected by the last reaction.</li></ul>
<p>
<ul>
<li>The propensities and the sum are initialized. Then, in the integration loop:</li><li>Before applying the reaction:<ul>
<li>Propensities of reaction channels that are affected by the next reaction are substracted from the sum.</li><li>Apply reaction.</li></ul>
</li><li>Compute propensities:<ul>
<li>Compute propensities of the channels affected by the last reaction.</li><li>Add the sum of the propensities of these channels to the sum.</li></ul>
</li><li>The propensities and their sum have been updated.</li></ul>
<p>
In this code, we only use the connections of the reactions between cell-cell and cell-milieu. We do not analyse the internal chemical system in the cell and the connections between reactions. 
</div>
</div><p>
<a class="anchor" name="aa71cbc6d4145167722309e835901f8e"></a><!-- doxytag: member="CellCollection::constantCellDensity_" ref="aa71cbc6d4145167722309e835901f8e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classCellCollection.html#aa71cbc6d4145167722309e835901f8e">CellCollection::constantCellDensity_</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
If true the cell density is kept constant by automatically killing the cells (at random) when cells duplicate. 
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>DATA/PROGS/COLONY/<a class="el" href="CellCollection_8h.html">CellCollection.h</a><li>DATA/PROGS/COLONY/<a class="el" href="CellCollection_8cpp.html">CellCollection.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Apr 20 13:50:18 2010 for Colony by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
